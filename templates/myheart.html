{% extends "base.html" %}
{% block head %}
    <link rel="stylesheet" href="../static/css/myheart.css">     
    <script src="{{ url_for('static', filename='js/myheart.js') }}" defer></script>   
{% endblock head %}

{% block section %}
    <div class="product-container">
        <div class="product-header">
            <h2>찜 목록 ({{ total_items }}개)</h2>
        </div>

        <div class="product-grid">
            {% if items %}
                {% for key, value in items.items() %}
                <div class="product-card">
                    <a href="{{ url_for('view_product_detail', name=key) }}" style="text-decoration: none; color: inherit; display: block;">
                        <img src="{{ value.img_path }}" alt="상품 이미지">
                        <div class="product-info">
                            <div class="product-name">{{ value.name }}</div>
                            <div class="product-price">{{ value.price }}원</div>
                        </div>
                    </a>
                    {# 찜 목록 페이지이므로 하트는 항상 active 상태 #}
                    <div class="heart active" data-product-id="{{ key }}">♥</div>
                </div>
                {% endfor %}
            {% else %}
                <p style="padding: 20px;">찜한 상품이 없습니다.</p>
            {% endif %}
        </div>
        
        <div class="pagination">
            {% set block_index = (page - 1) // 5 %}           
            {% set start_page = block_index * 5 + 1 %}       
            {% set end_page = start_page + 4 %}
            {% if end_page > total_pages %}
                {% set end_page = total_pages %}
            {% endif %}

            {% if start_page > 1 %}
                <a href="{{url_for('view_heart', page=start_page - 1)}}" class="page-btn">&lt;</a>
            {% endif %}

            {% for i in range(start_page, end_page + 1) %}
                <a href="{{ url_for('view_heart', page=i) }}"
                   class="page-btn {% if i == page %}active{% endif %}">
                    {{ i }}
                </a>        
            {% endfor %}

            {% if end_page < total_pages %}
                <a href="{{ url_for('view_heart', page=end_page + 1) }}" class="page-btn">&gt;</a>
            {% endif %}
        </div>
    </div>
{% endblock section %}