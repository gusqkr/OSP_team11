{% extends "base.html" %}
{% block head %}
    <link rel="stylesheet" href="../static/css/mypage.css">    
{% endblock head %}

{% block section %}
    <div class="product-container">
        <div class="product-header">마이페이지</div><hr>
        <p class="small-header">내가 올린 상품</p>
        <div class="product-grid">
            {% if my_selling %}
                {% for key, item in my_selling.items() %}
                <div class="product-card">
                    <a href="{{ url_for('view_product_detail', name=key) }}" style="text-decoration: none; color: inherit;">
                        <img src="{{ item.img_path }}" alt="상품 이미지">
                        <div class="product-info">
                            <div class="product-name">{{ item.name }}</div>
                            <div class="product-price">{{ item.price }}원</div>
                            {% if item.selling_status == 'sold' %}
                                <div style="color: red; font-size: 0.8rem;">(판매완료)</div>
                            {% endif %}
                        </div>
                    </a>
                </div>
                {% endfor %}
            {% else %}
                <p style="padding: 10px; color: #777;">올린 상품이 없습니다.</p>
            {% endif %}
        </div>
    </div>

    <div class="product-container">
        <p class="small-header">내가 구매한 상품</p>
        <div class="product-grid">
            {% if my_purchases %}
                {% for key, item in my_purchases.items() %}
                <div class="product-card">
                <a href="{{ url_for('view_product_detail', name=key) }}" style="text-decoration: none; color: inherit;">
                <img src="{{ item.img_path }}" alt="상품 이미지">
                    <div class="product-info">
                        <div class="product-name">{{ item.name }}</div>
                        <div class="product-price">{{ item.price }}원</div>
                    </div>
                </a>
                </div>
                {% endfor %}
            {% else %}
                <p style="padding: 10px; color: #777;">구매한 상품이 없습니다.</p>
            {% endif %}
        </div>
    </div>

<div class="review-container">
        <p class="small-header">내가 작성한 리뷰</p>
        <div class="review-grid">
            {% if my_reviews %}
                {% for key, review in my_reviews.items() %}
                <div class="review-card">
                    <a href="{{ url_for('view_review_detail', review_id=key) }}" style="text-decoration: none; color: inherit; display: flex; width: 100%;">
                        <div class="review-content" style="flex: 1;">
                            <h3 class="review-title">{{ review.title }}</h3>
                            <p class="review-subtitle">{{ review.item_name }} 구매</p>
                            <div class="review-stars">
                                {% for i in range(review.rating | int) %}
                                    <span>★</span>
                                {% endfor %}
                            </div>
                        </div>
                        {% if review.img_path %}
                        <img src="{{ url_for('static', filename='images/' + review.img_path) }}" 
                             alt="리뷰 상품 이미지" class="review-image">
                        {% endif %}
                    </a>
                </div>
                {% endfor %}
            {% else %}
                <p style="padding: 10px; color: #777;">작성한 리뷰가 없습니다.</p>
            {% endif %}
        </div>
    </div>

    <div class="edit-container">
        <p class="small-header">회원정보 수정하기</p>

        <form class="edit-form">
            <div class="form-group">
                <label for="user-id">아이디</label>
                <input type="text" id="user-id" value="{{ user_info.id }}" readonly>
            </div>

            <div class="form-group">
                <label for="new-password">새 비밀번호</label>
                <div class="password-form">
                    <input type="password" id="new-password" placeholder="">
                    <button type="button" class="toggle-password">
                        <img src="../static/images/eye-off.png" alt="비밀번호 보기" class="eye-icon">
                    </button>
                </div>
            </div>

            <p class="guide-text">영문, 숫자 포함 8자 이상 작성해주세요.</p>

            <div class="form-group">
                <label for="confirm-password">새 비밀번호 확인</label>
                <div class="password-form">
                    <input type="password" id="confirm-password" placeholder="">
                    <button type="button" class="toggle-password">
                        <img src="../static/images/eye-off.png" alt="비밀번호 보기" class="eye-icon">
                    </button>
                </div>
            </div>

            <div class="form-group">
                <label for="email">이메일</label>
                <input type="text" id="user-email" value="{{ user_info.email }}" readonly>
            </div>

            <div class="form-group">
                <label for="phone">전화번호(선택)</label>
                <input type="text" id="phone" value="{{ user_info.tel if user_info.tel else '' }}" placeholder="">
            </div>
        </form>
    </div>

    <button type="submit" class="edit-btn">변경하기</button>
{% endblock section %}



